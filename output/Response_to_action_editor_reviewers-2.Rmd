---
output:
  officedown::rdocx_document:
    mapstyles:
      First Paragraph: Body Text
    base_format: bookdown::word_document2
    reference_docx: ../www/Template.docx
    number_sections: no
    keep_md:         no
bibliography: ../www/Multidimensional-parameters-MCLM.bib
csl:          ../www/apa-old-doi-prefix.csl
editor_options: 
  chunk_output_type: console
---

```{r setup}
#| include: false

# Includes:

library(here)
library(knitr)
library(patchwork)
library(ggplot2)
library(rstudioapi)
library(svglite) # Used by {knitr} and {ggplot2} to render the figure to SVG;
                 #   added to prevent {renv} from reporting inconsistent state.
library(officer)

ROOT_DIR <- here()
DOC_DIR  <- file.path(ROOT_DIR, "output")

opts_knit$set(root.dir = ROOT_DIR)
opts_chunk$set(
  echo     = FALSE,
  message  = FALSE,
  cache    = FALSE,
  dev      = "png",
  dpi      = 1200L,
  dev.args = list(type = "cairo-png"),
  tab.cap.fp_text = fp_text_lite(italic = FALSE, bold = TRUE),
  fig.cap.fp_text = fp_text_lite(italic = FALSE, bold = TRUE)
)

# Output configuration options:
options(digits = 3)
```

```{r sources}
#| cache:   false
#| include: false
source("R/Formulae.R",                  encoding = 'UTF-8')
source("R/Constants.R",                 encoding = 'UTF-8')
source("src/Graphical_example_paper.R", encoding = 'UTF-8')
```

# Responses to the action editor:

###### 1) Minor grammatical errors/phrasing, as pointed out by Thissen’s (who is Reviewer 4 according to ScholarOne) Review 1 (that is attached) need to be addressed.

We have made most of the corrections suggested by Thissen (with only two exceptions, see below), which no doubt will improve the quality of our manuscript.
We would also like to thank this reviewer for having the courtesy of performing this thorough grammar review; being the authors non-native English speakers, we have made the mistake of being overconfident on our language skills and automatic correction tools.
This review has also helped to set our confidence to a more realistic level for future submissions.

The only suggestions not accepted are:

In p. 4 (line 2), we think that "the two dimensions [...] _combine_ in the second group" does not reflect accurately the fact that the two dimensions are collapsed into a single one when the correlation is 1.
We have therefore decided to just drop this clause, as it is redundant with the previous one which states that "the two dimensions are _perfectly aligned_".
This sentence now reads:

> [...] because the two dimensions are *perfectly aligned* in the second group,
the item `r MDISC_SYM` should be the algebraic sum of both components, [...]

In p. 13 (line 2), dropping "up", i.e., "the squared direction cosines sum ~up~ to 1", did not sound well to us, so instead we reformulated the sentence as:

> To compute the direction of the maximum slope,
Reckase leverages the property that
the sum of the squared direction cosines equals 1 (see Equation 7 therein).
[...]

Finally, the sentence that was found difficult to understand in the abstract (p. 1, lines 5-7) has been rewritten as follows:

>  [...]
We apply Reckase's maximum discrimination point method to define them in an
arbitrary algebraic basis.
Then, we define such basis to be a
geometrical representation of the measured construct. [...]

###### 2) I would like to see the graphics improved as suggested by Thissen's Review 2.  Labeling of axes is key for clarity.  And providing contour plots of the factor score ( latent variable) distributions will also help the reader’s understanding, especially for those readers coming from the IRT perspective.

We have made the changes proposed, updated the figure caption accordingly, and added an appropriate footer.
These changes have required a rather high effort to make sure they represent the algebra adequately, as well as some edits to improve the clarity of the plots and justify the computations.
Please see our detailed responses to Thissen's comments below.

###### 3) I would like to see additional comments in their closing paragraph on how testing practitioners should use or what insights can be obtained by reviewing the different representations of the latent ability space and the item space. I see the mention of multigroup equating/linking, but I would like to see more discussion about how the test results and subsequent uses could be affected.

We have tried our best to give a satisfactory response to this comment.
Although we acknowledge that we are not completely sure we have succeeded, we have carefully thought about the broader implications to our results, and made changes to our "Discussion" section to address this comment.
Besides some minor changes to adapt our discussion (please refer to the tracked changes in the main text of the submission), we have made two major changes.
The first one is the inclusion of additional comments to discuss the implications in terms of the test results and how their uses could be affected.
They have been included in what was previously the second paragraph;
we consider this text was misplaced in our previous version and have moved it accordingly, nearly to the end of the section.
After the changes, this paragraph (now in p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->) reads:

> We have seen that taking the latent space structure into account may have a
> substantial effect in the resulting values and
> interpretation of the parameters, something not contemplated by the original
> (hereby referred to as agnostic) version.
> Interpreting the item properties correctly requires a solid understanding of
> their relationship with the latent covariance structure,
> and we have shown that this can only be achieved
> with a proper geometrical representation.
> Simple items are not affected much by this issue but,
> as MIRT evolves and converges with the common factor psychometric tradition,
> we find MIRT models applied more often to new problems,
> involving complex multidimensional item structures
> (even including items with opposite-signed loadings).
> Our results will be especially relevant in those cases,
> where the interpretation of the items may be affected more drastically.
> For example, the relative importance of an item in scoring a given trait
> could be downplayed if it is strongly aligned with that trait dimension
> but this alignment is overlooked.
> Once again, in multi-group applications,
> where differences in the latent space structure is critical,
> the agnostic version may overlook relevant differences in
> the values of the multidimensional parameters.
> Different covariance structures across groups may significantly affect them
> due to differences in either the variances or the correlation structure.
> Therefore, even when the model parameters are equal across groups,
> the multidimensional parameters may not be the same
> if the covariance structures differ.
> Conversely, the same multidimensional parameters may correspond
> to different parameter models.
> The subsequent invariance of either the M2PL parameters
> or the multidimensional ones may lead to different interpretations of
> the same model when applied to different groups.
> Although this is an empirical question that requires further research,
> it could have significant implications for future theoretical developments
> in the understanding of MIRT theory.

Regarding the insights that can be obtained from the different representations,
we hope that the changes to Figure 1 and the subsequent additions
should account for how the test space representation should be interpreted.
Regarding the latent space, our latest version already stated that "the axes defined by the test space basis, and not the ones defined by the latent space basis, are a geometrical representation of the covariance structure. Indeed, the cosines of the angles among the test space axes are the geometric equivalent of the correlations. This result is both surprising and counterintuitive [...]".
The manuscript implicitly showed that the latent space transformation is as an "geometric artifact", necessary for arriving at the proper representation of the items in the test space.
We acknowledge though that this might not be necessarily clear in the previous submission.
The second change in the discussion consists of stating this explicitly now at the end of the fourth paragraph (previously the fifth one) of the "Discussion" section, in p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->:

> [...] In fact, we have only defined the latent space as a geometrical artifact
> for obtaining the multidimensional parameters.
> Interpreting the items in the latent space
> could only lead researchers to wrong conclusions. [...]

Besides the aforementioned changes, we would like to highlight a minor addition to the "Covariance-based version" section, to refer to the transformation of the latent trait distribution into another one with an identity covariance matrix by its usual name in the literature, i.e., a "whitening transformation".
The second paragraph of this section (p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->) now reads:

> Therefore, an orthonormal basis should represent independent,
> standard coordinates.
> Formally, if $`r COV_MATRIX_ORTH`$ is the covariance matrix of
> $`r TRAIT_ORTH_COORDS`$, then $`r COV_MATRIX_ORTH_EQ`$,
> which implies that Equation (2) actually represents
> a *whitening transformation* [@fukunaga_introduction_2013].
> Given this, $`r COV_MATRIX_TRANSF_EQ`$, and thus

(Please note also the update in the title page to acknowledge the colleague who brought this previous literature to our attention, as well as the contributions of the reviewers.)

# Responses to Reviewer 4:

###### It is always best, many would say required, to label the axes. The lack of axis labels in the graphics of Figure 1 make the rest of these comments difficult to type, so for convenience I imagine the axes are labeled conventionally x and y in the left panel, and x and y' in the right panel, indicating that y' is a rotated representation of y. (In the ms., it would be best to tie the labeling notation to the algebra used.)

We had overlooked labelling the axes and have done so in this new version;
we thank the reviewer once again for pointing this out.
$`r TRAIT_COMP_1`$/$`r TRAIT_COMP_2`$ have been used as labels for simplicity
(both in the code for plotting them, and for the reader's understanding),
but note that they represent the coordinates of
a latent trait point transformed to the test space,
that is, $`r TRAIT_COORD_1`$/$`r TRAIT_COORD_2`$.
However, there is a direct correspondence between the algebraic components and
the coordinates in either space, so this labeling should be clear enough,
while relying only upon the algebraic interpretation of the model,
thus avoiding the geometrical details,
which are only necessary for deriving the results.
This choice of labeling is explained in the text in p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->:

> (The axes are labelled as $`r TRAIT_COMP_1`$ and $`r TRAIT_COMP_2`$
> for simplicity, but note that they represent the coordinates of
> a latent trait point expressed in test space coordinates,
> that is, $`r TRAIT_COORD_1`$ and  $`r TRAIT_COORD_2`$.)

###### One part of the factor model that is understated in this ms. is the population distribution of the factor scores (not estimates, but the latent variable values). That could be ameliorated by adding a few contours of the bivariate normal (0, 1, rho=0) (that is, circles :) to the left panel graphic. That population distribution is implicit in EFA, and the original Reckase work.

Our understanding of Reckase's original work is the same as the reviewer's:
That the orthogonality (actually, orthonormality) assumption was implicit at the time of @reckase_difficulty_1985.
Because of that, an orthonormal (not just orthogonal) basis was a sound assumption.
However, as Multidimensional IRT theory became mainstream, some applied researchers started applying these and Reckase and McKinley's -@reckase_discriminating_1991 formulae without noticing they were applying them to a more general case with non-orthonormal dimensions, finding inconsistencies in their estimates (this topic is part of another work-in-progress manuscript).

We have added the contour plots to the left panel of Figure 1 (panel (a) in the new version), as suggested.

###### Then one could make another version of the left panel with contours for the rho=0.5 population distribution. Comparison of that with the previously-described version would show that the arrows representing discrimination do not have the same numerical meaning with respect to the variance (standard deviation) of the population distribution *in the direction of the arrows*, which is part of the point of all of this.
 
###### Two graphics with orthogonal axes but different population distributions are the way orthogonal vs. oblique solutions are represented in MIRT analyses. The ms. misses an opportunity to clarify that. Different population distributions on orthogonal axes are the way MIRT folks have thought about factor correlation; factor analysts have thought about 'rotation' and oblique axes (the left panel of Figure 1); it's two sides of the same coin.

This is indeed the message we want to convey with our manuscript, and are thankful to the reviewer for the comments.
We have taken into account the suggestion and added the contours plots accordingly.
This is represented as panel (b) in the new version.
The text also explains the different interpretation of the coordinates relative to the distribution now.
Please see the new paragraph added in third place in section "Graphical Representation Example" (p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->):

> Panels (a) and (b) show that,
> even if the agnostic coordinates are the same in both cases,
> their relative position with respect to the latent trait distribution is not
> ---this is the effect of disregarding the covariance structure.
> The correlation-based coordinates, plotted in panels (c) and (d),
> are also different in general from their agnostic counterpart (panel (b)).
> Although they do not vary in some cases (items 1 and 4),
> the difference is especially salient in the location of items 2 and 3,
> which are close to the 90% contour in the agnostic version
> but almost on the 50% contour in the correlation-based one. [...]

###### This graphic is potentially confusing. In addition to the absence of axis labels mentioned above, it has oddly placed gray dotted grid lines. I would think it would have vertical gray dotted grid lines showing placement on the horizontal axis (x), and oblique gray dotted grid lines (orthogonal to y') showing placement on the (oblique) axis y'. With axis values -2 ... 0 ... +2 at the margins of *those* gridlines. Instead, it has the opposite: labeled horizontal grid lines that don't correspond to any axis values, and oblique grid lines labeled 0-1-2-3-4 that similarly don't correspond to any axis, but rather to how far away a point is from y'. Basically, the graphic would be easier to understand with labels on the axes, and two sets of grid lines orthogonal to those that are currently there (omitting those that are currently there).

We understand this graphic may be hard to interpret, but our interpretation is that the grid lines are properly placed.
The rationale is as follows:
Each point in the test space is intended to represent a coordinate vector, which is the displacement from the origin given by a linear combination of the basis vectors, with the components of the coordinate vector being the coefficients of those basis vectors (please refer to the expression $`r DISCR_COORDS_ALT_EQ`$ in p. 8 of the previous version of our manuscript, or p. <!-- # TODO: Complete --> in the new submission).
For example, the tip of the vector representing item 1 is at coordinate (+2, +2).
This means the point is displaced twice the length of the first vector basis along its direction (i.e., two units along the horizontal axis) and then twice the length of the first vector basis along its direction (i.e., another two units parallel to the direction of the oblique axis).
These displacements, parallel to the direction of the axes, are what the grid lines intend to represent.
This representation is somewhat equivalent to a _factor pattern_ (i.e., description in linear combination terms, see @harman_modern_1976, p. 267) representation in the factor model, while the one proposed by the reviewer would be paralleled by the _factor structure_ representation (i.e., description in terms of correlations with the latent dimensions).
Please see @harman_modern_1976 (p. 265 and p. 267, respectively) for the two representations.
This can be more easily understood by comparing figures 4.2 (p. 61, a representation equivalent to the one we propose) and 12.8 (p. 266) in @harman_modern_1976.

###### That said, one could also add elliptical contours representing the population distribution to the left panel of Figure 1. That would be a little complicated to compute; it's a "squeezed in" ellipsoid due to the rotation of the y axis to y'. but when compared to a version of the right panel with ellipses for a correlation of 0.5, the arrows would represent the same numerical values of discrimination relative to the standard deviation of the population in the arrows' directions.

As suggested, we have added these elliptical contours.
The computation is also explained in the text; to clarify it, we have had to add some additional results in previous parts of the manuscript.
The changes we have made in this new version are the following:

- The second paragraph of section "Relationship Between Test Space and Latent Space" explains how coordinates can be converted from the latent trait to the test space, and vice versa.
For explaining this, we have needed to add and reference two new equations.
This paragraph (p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->) now reads as follows:

> [...]
> First, the transformation to the orthonormal bases of the two spaces allows
> mapping the $`r MODEL_ACRONYM`$ parameters interchangeably in the two spaces,
> by projecting one space onto the other;
> that is, we can set
> 
> \begin{equation}
>   `r TRAIT_COORDS_ORTH_SPACES_EQ` \t (23)
> \end{equation}
> 
> 
> for any point, $`r TRAIT_VECTOR`$ or $`r DISCR_VECTOR`$.
> This allows representing the coordinates of the latent space vectors
> in the test space and, conversely,
> the coordinates of the discrimination vectors in the latent space:
> By Equations (2), (5), and (23)
> any coordinate vector $`r TRAIT_COORDS`$ in $`r LS_BASIS`$
> can be expressed in $`r TEST_SPACE_BASIS`$ as
> 
> \begin{equation}
>   `r TRAIT_COORDS_TS_EQ`, \t (24)
> \end{equation}
>   
> and vice versa. [...]

- The second paragraph in section "Graphical Representation" now clarifies better that the representation in the test space must use its basis instead of the canonical basis, to make the plot be a faithful representation of the actual directions of the items with respect to the latent trait dimensions.
This paragraph now reads (p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete -->):

> [...] Coordinates in a rectangular Cartesian system are commonly assumed
> to be simply represented in the canonical basis.
> To represent an item in the test space properly, however,
> we must use its basis $`r TEST_SPACE_BASIS`$,
> which implies pre-multiplying its coordinates
> by $`r TRANSFORM_MATRIX_TRANSP_INV`$
> to find the equivalent coordinates in the canonical basis. [...]

- The section "Graphical Representation Example" has been expanded to explain better both Table 1 and Figure 1.
Starting in the first paragraph (p. <!-- # TODO: Complete -->, l. <!-- # TODO: Complete -->), this section now reads:

> [...] The example in Figure 1 showcases a representation of
> a set of items with two different latent trait distributions.
> (The axes are labelled as $`r TRAIT_COMP_1`$ and $`r TRAIT_COMP_2`$
> for simplicity, but note that they represent the coordinates of
> a latent trait point expressed in test space coordinates,
> that is, $`r TRAIT_COORD_1`$ and  $`r TRAIT_COORD_2`$.)
> Their parameters are shown in Table 1,
> both in the original `r MODEL_ACRONYM` metric and
> in the multidimensional metric under the two cases,
> which differ in the latent trait correlation.
> In the first case (columns $`r CORR_ORTH_OUT`$),
> the two latent dimensions are independent;
> in the second one ($`r CORR_OBL_OUT`$),
> the correlation between them is .5.
> The same `r MODEL_ACRONYM` parameters are used in both cases,
> but their (correlation-based) multidimensional parameters change
> with the correlation.
> If we used the agnostic version instead, the multidimensional parameters,
> given by the values under $`r CORR_ORTH_OUT`$, would be the same in both cases.
> 
> Panel (a) of Figure 1 shows
> the item representation in the uncorrelated case,
> while the $`r CORR_OBL_OUT`$ case is shown in panels (b) to (d)
> under different conditions:
> with item coordinates computed from the agnostic version of the parameters
> (panel (b)), or from the correlation-based version,
> either using an appropriate oblique basis (panel (c)),
> or plotting them directly in the canonical basis (panel (d)).
> Keeping the horizontal axis invariant in panel (c)
> allows for a better comparison with the other plots;
> therefore, we have chosen a $`r TRANSFORM_MATRIX_TRANSP_INV`$ that
> only rotates the vertical axis [@harman_modern_1976]:
> 
> \begin{equation}
>   `r TRANSFORM_MATRIX_EXAMPLE_EQ`.
> \end{equation}
> 
> In all four panels, the contours of a bivariate standard normal density
> with the corresponding correlation are plotted along with the items
> (from outer to inner, the contours are the `r contour_breaks_out` of
> the density at its mode).
> The stretched ellipses in panel (c) are the result of transforming
> the distribution in the latent space to the test space,
> according to Equation (24).
> This implies that the covariance matrix of the distribution projected into
> the test space is transformed inversely as in the latent space, i.e.,
> $`r COV_MATRIX_TRANSF_TS_EQ`$.
> 
> Panels (a) and (b) show that,
> even if the agnostic coordinates are the same in both cases,
> their relative position with respect to the latent trait distribution is not
> ---this is the effect of disregarding the covariance structure.
> The correlation-based coordinates, plotted in panels (c) and (d),
> are also different in general from their agnostic counterpart (panel (b)).
> Although they do not vary in some cases (items 1 and 4),
> the difference is especially salient in the location of items 2 and 3,
> which are close to the 90% contour in the agnostic version
> but almost on the 50% contour in the correlation-based one.
> Panel (d) also illustrates the effect of plotting the coordinates directly
> on the canonical basis;
> the item locations and their positions relative to the distribution
> are correctly represented (which makes comparing with panel (b) easier),
> but their discrimination parameters and angles with the axes are distorted:
> For example, items 4 and 5 seem to be equally discriminating,
> when Table 1 panel (c) show they are not;
> and item 1 forms 45-degree angles with both axes,
> instead of the 30-degree ones shown in Table 1.
> 
> A comparison of panels (a) and (c) allows understanding the effect of
> a positive correlation on the $`r MDISC_CORR_PARAM`$
> (and consequently the $`r MIL_CORR_PARAM`$) value: [...]

Finally, we have added a fourth panel (panel (d)) that illustrates how the items would be plotted if we omitted using the proper test space basis (and just using the canonical basis instead).
Incidentally, this also serves the purpose of allowing an easier comparison of the coordinates computed from the two versions (the agnostic, and the correlation-based one) of the multidimensional parameters.
We have briefly explained this in p. <!-- # TODO: Complete -->, ll. <!-- # TODO: Complete --> (please refer to the changes explained above).

# References
